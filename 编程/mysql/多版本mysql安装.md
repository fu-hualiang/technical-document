### 1.删除MySql服务

使用管理员身份打开cmd（不是PowerShell），输入命令

sc delete mysql

命令中的mysql为服务名称。删除完成之后，查看“服务”，如果找不到MySql服务，说明已经已经删除成功。如果还能看到MySql服务，可以⼿动右击选择”停⽌“，服务停⽌之后就会⾃动消失了。

### 2.新建my.ini配置文件

在mysql程序的根⽬录下，新建⼀个my.ini空⽩⽂件，⽤记事本打开，将以下内容复制进去，保存。

port设置端口，basedir 和 datadir 根据实际MySql安装的位置进⾏修改。

```
[mysqld]
port=3307
basedir=D:\\Tools\\mysql\\mysql-5.7.36-winx64
datadir=D:\\Tools\\mysql\\mysql-5.7.36-winx64\\data

[mysql]

[client]
port=3307
```

```
# For advice on how to change settings please see
# http://dev.mysql.com/doc/refman/5.6/en/server-configuration-defaults.html
# *** DO NOT EDIT THIS FILE. It's a template which will be copied to the
# *** default location during install, and will be replaced if you
# *** upgrade to a newer version of MySQL.
[client]
default-character-set = utf8mb4
[mysql]
default-character-set = utf8mb4
[mysqld]
character-set-client-handshake = FALSE	
character-set-server = utf8mb4
collation-server = utf8mb4_bin
init_connect='SET NAMES utf8mb4'
# Remove leading # and set to the amount of RAM for the most important data
# cache in MySQL. Start at 70% of total RAM for dedicated server, else 10%.
innodb_buffer_pool_size = 128M
# Remove leading # to turn on a very important data integrity option: logging
# changes to the binary log between backups.
# log_bin
# These are commonly set, remove the # and set as required.
basedir = D:\MySQL
datadir = D:\MySQL\data
port = 3306
# server_id = .....
# Remove leading # to set options mainly useful for reporting servers.
# The server defaults are faster for transactions and fast SELECTs.
# Adjust sizes as needed, experiment to find the optimal values.
join_buffer_size = 128M
sort_buffer_size = 16M
read_rnd_buffer_size = 16M 
sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES
```

### 3.重新生成data文件

删除之前⽣成的data⽂件，如果有重要的数据表，请先备份好。回到cmd，运⾏：

mysqld --initialize-insecure --user=mysql

该命令需要执⾏⼤概⼀分钟左右，完成后会在MySql程序⽂件夹下重新⽣成名称为data的⽂件夹

（可选）如果遇到“TIMESTAMP with implicit DEFAULT value is deprecated.”，可以在my.ini文件的[mysqld]下添explicit_defaults_for_timestamp=true。

如果遇到“--initialize specified but the data directory has files in it. Aborting.”，删除data文件夹。

### 4.重新安装mysql服务，同时绑定my.ini配置文件

安装MySql服务，同时设置绑定my.ini配置⽂件。命令：

mysqld --install MySQL5 --defaults-file=..\my.ini

“MySQL5”是服务名称，80表示8.0版本，当然，也可以自己取别的名字。”..\my.ini“是新建的配置⽂件的位置，也可以写成绝对路径”D:\MySql\my.ini“。

### 5.启动服务

命令：

net start mysql5

如果不成功，可能是my.ini配置⽂件中的某些配置有问题。可以修改ini⽂件内容，然后从头按步骤再试⼀遍。

### 6.重新设置密码

登录mysql，命令：

mysql -u root -p

指定端口的命令（P要大写）

mysql -P 3307 -u root -p

这时密码为空，不需要填写